class Pet{constructor(t){this.name=t&&"string"==typeof t.name?t.name:"",this.surname=t&&"object"==typeof t.surname&&"number"==typeof t.surname.length?t.surname.map(function(t){return"string"==typeof t?t:""}):[],this.words=t&&"object"==typeof t.words&&"number"==typeof t.words.length?t.words.map(function(t){return"string"==typeof t?t:""}):[],this.actions=t&&"object"==typeof t.actions&&"number"==typeof t.actions.length?t.actions.map(function(t){return"string"==typeof t?t:""}):[],this.listenDuration=t&&"number"==typeof t.listenDuration&&isFinite(t.listenDuration)?t.listenDuration:25e3,this.listening=!1;const n="SpeechRecognition"in window?window.SpeechRecognition:"webkitSpeechRecognition"in window?window.webkitSpeechRecognition:null,e="SpeechGrammarList"in window?window.SpeechGrammarList:"webkitSpeechGrammarList"in window?window.webkitSpeechGrammarList:null,i="SpeechRecognitionEvent"in window?window.SpeechRecognitionEvent:"webkitSpeechRecognitionEvent"in window?window.webkitSpeechRecognitionEvent:null;if(this.supported=![n,i].includes(null),this.recognition,this.eventListeners=[],this.supported){const i=this;if(this.recognition=new n,this.recognition.grammars&&e){const t=new e;t.addFromString(`#JSGF V1.0; grammar virtual_pet; public <virtual_pet> = ${i.words.concat([i.name,...i.surname],i.actions).join(" | ")} ;`,1),this.recognition.grammars=t}this.recognition.continuous=!0,this.recognition.lang=t&&"string"==typeof t.lang&&t.lang||"en-US",this.recognition.interimResults=!1,this.recognition.maxAlternatives=1,this.recognition.addEventListener("result",function(t){const n=[].concat.apply([],[...t.results].map(function(t){return t[0].transcript.split(" ")})),e=n.filter(function(t){return t===name||i.surname.includes(t)}),s=n.filter(function(t){return i.actions.includes(t)}),o=n.filter(function(t){return i.words.includes(t)});!i.listening&&e.length?i.listen():s.length?(i.dispatchEvent("action",{action:s[0],words:o,transcript:n.join(" ")}),i.stopListen(!0)):o.length&&(i.dispatchEvent("words",{words:o,transcript:n.join(" ")}),i.stopListen(!0)),i.dispatchEvent("result",{transcript:n.join(" ")})}),this.recognition.addEventListener("speechend",function(){i.recognition.stop()}),this.recognition.addEventListener("error",function(t){console.error(t.error)})}else console.error("Browser is not compatible with this module.")}dispatchEvent(t,n){const e=this;this.eventListeners.forEach(function(i){i&&i.event===t&&i.callback.bind(e)(n)})}addEventListener(t,n){const e={event:t,callback:n};return this.eventListeners.push(e),e}removeEventListener(t,n){if(this.eventListeners.includes(t))this.eventListeners[this.eventListeners.indexOf(t)]=null;else{if(!this.eventListeners.includes({event:t,callback:n}))return!1;this.eventListeners[this.eventListeners.indexOf({event:t,callback:n})]=null}}listen(){if(!this.supported)return;this.listening=!0;const t=this;setTimeout(function(){t.stopListen()},this.listenDuration),this.recognition.abort(),this.recognition.start(),this.dispatchEvent("listen",null)}stopListen(t){this.supported&&(this.listening=!1,t?this.recognition.abort():this.recognition.stop(),this.dispatchEvent("stoplisten",null))}}